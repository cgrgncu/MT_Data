# Anna Kelbert

## Kelbert, A. (2020). EMTF XML: New data interchange format and conversion tools for electromagnetic transfer functions. Geophysics, 85(1), F1-F17.
+ 下載位置: https://www.researchgate.net/publication/336343650_EMTF_XML_New_Data_Interchange_Format_and_Conversion_Tools_for_Electromagnetic_Transfer_Functions
+ 備份: Kelbert, A. (2020). EMTF XML: New data interchange format and conversion tools for electromagnetic transfer functions. Geophysics, 85(1), F1-F17.pdf

### 摘要
+ 大地電磁法資料蒐集的初始處理(Initial processing)會將結果記錄在小檔案中，描述大地電磁法在多個離散的不同頻率的轉換函數或變量。
+ 雖然檔案內容不是很大，但轉換函數代表了原始資料中幾乎所有有關地球電導率的信息，並為地球物理反演和地磁災害緩解程序提供了關鍵輸入。
+ 然而，為了對科學解釋有用，大地電磁法轉換函數必須附有仔細記錄的詮釋資料(metadata)。
+ 我們開發了一種新的 MT 格式和相關的電磁傳遞函數可擴展標記語言（EMTF XML），這是一種新穎的、自描述的、可搜索的、可擴展的數據存儲方式。
+ 我們還評估了我們的開源、功能強大的轉換工具，該工具實現了歷史MT TF格式（電子數據交換[EDI]、EDI SPECTRA、Z 文件和潛在的其他格式）和EMTF XML 之間的格式轉換，並且我們研究了以下相關問題：數據輪換。 
+ 我們將我們的工作與開源格式轉換工具 EMTF FCU v4.0 結合起來，並提供用戶指南和一組用例示例。
+ 我們希望這項工作能夠幫助機器翻譯社區創建更加開放的數據共享文化和實踐。

### INTRODUCTION
+ 大地電磁學 (MT) 是一種與地震學互補的地球物理技術，它利用電磁 (EM) 波傳播來推斷地殼和地函的電導率。
+ 為此，MT 使用來自太陽風和閃電的大規模天然場源。
+ 現代機器翻譯使用最先進的儀器、數據處理和分析工具來提供有關地球深層結構的有價值的信息。(e.g., Unsworth et al., 1997; Evans et al., 1999; Wei et al., 2001; Booker et al., 2004; Unsworth et al., 2005; Soyer and Unsworth, 2006; Wannamaker et al., 2009; Kelbert et al., 2012; Meqbel et al., 2014; Murphy and Egbert, 2017). 
+ 傳統的 MT 平面波源假設允許電離層源分解為兩個極化：從南到北和從西到東。
+ 傳遞函數 (TF) 抵消了源的幅度； 因此，它們可以在平面波假設下使用，而無需明確估計自然源的振幅。
+ 因此，MT 數據處理的最終產品（MT 阻抗和傾子）採用 TF 的形式：頻域張量，根據定義，將輸出 EM 數據通道與輸入 EM 數據通道相關聯。
+ 傳統上，MT 方法使用兩個水平磁場分量作為輸入。
+ 本地和遠距離測量的多個電場和磁場分量可以作為TF的輸出。
+ 在這裡，我們專注於以穩健、有據可查、基於矩陣的公式記錄一般電磁傳遞函數 (EMTF)
+ 隨著MT 科學在20 世紀80 年代和90 年代的成熟，EMTF 大部分被創建並存儲在歷史上的勘探地球物理學家協會(SEG) 1987 年數據交換標準中，也稱為電氣數據交換(EDI )（Wight，1988）。
+ 這種 ASCII 格式在開發時相當全面，但它不再支持現代地球物理學中遇到的 MT 數據和詮釋資料的許多種類和組件。
+ 更重要的是，EDI 文件的格式和詮釋資料內容並不特別支持數據共享，這實際上在 MT 中尚未成為常見做法。
+ 事實上，在此之前，歷史觀測活動的 MT 傳遞函數（MT TF）尚未廣泛或容易獲得。
+ 因此，計劃實驗的研究人員通常是“在黑暗中”，除了通過直接個人通信收集的信息和獲得的數據外，無法訪問相同或附近區域的先前數據。
+ 更完整、更免費地獲取來自同行和歷史調查的數字數據對於規劃觀測活動以及在反演和解釋階段利用新數據的空間覆蓋具有重要價值。
+ 鑑於最近成熟且廣泛使用的 3D MT 反演功能（Siripunvaraporn 等人，2005 年；Egbert 和 Kelbert，2012 年；Kelbert 等人，2014 年），開放和直接訪問歷史 MT 數據現在特別有價值。多個數據集的組合作為綜合解釋的一部分，使用大規模、高分辨率的地面結構反演。
+ 在某些情況下（例如，來自石油和天然氣或地熱行業以及一些國際合作的數據），無法立即免費提供最終數據產品。
+ 在這種情況下，存儲可搜索的元數據標頭仍然很有用，以便計劃新實驗的研究人員可以輕鬆找出存在哪些數據並與數據所有者協調訪問。
+ 在這裡，我們討論了機器翻譯中數據共享的技術和社會障礙，並討論了我們的解決方案，其中包括新穎、靈活且可搜索的數據格式； 格式轉換工具； 信用歸屬方法； 以及一個可公開訪問的 EMTF 數據庫。
+ 通過結合這些技術，我們希望為 MT 社區中的數據共享新文化提供一條途徑。

### EFFORTS TOWARD A NEW EMTF STANDARD
+ 傳統的MT數據格式多種多樣且相當不穩定。
+ 大多數情況下，沒有免費的閱讀器可供使用：相反，大量“自製”讀寫工具激增（一個值得注意的例外是 Krieger 和 Peacock 開發的強大的通用開源 Python 包 MTpy [2014] ，它提供了部分解決方案）。
+ 部分挑戰在於歷史文件格式的巨大異質性。
+ 具體來說，EDI 文件（Wight，1988）允許足夠的文件可變性，到目前為止，還沒有任何一個工具聲稱能夠讀取所有文件。
+ 問題的另一部分是詮釋資料或缺乏詮釋資料。
+ 詮釋資料對於長期數據歸檔和共享至關重要。
+ 歷史 EDI 文件因沒有足夠的詮釋資料而臭名昭著；例如，一種常見的做法省略了測量位置的緯度和經度，而是選擇以米或英尺為單位提供的距公共參考點的距離（不包括用於計算該距離的投影）。
+ 在這些歷史文件中很少能找到關鍵信息，例如用於數據處理的符號約定、遠程參考站點信息和出處。
+ 數據固有的異質性是社區遠離健康數據共享實踐的障礙之一。
+ 歷史數據中另一個非常模糊的來源是方向。
+ 所有 TF 都與通道對相關。
+ 這些通道是電場和磁場的組成部分，它們都是矢量，並且具有方向。
+ 對於大多數歷史上的 EMTF，其輪換方式都存在模糊性。
+ 它們可以匹配文件中寫入的通道方向，也可以旋轉到一組正交坐標，與地理北角成一定角度（可以為零，但不一定是零）。
+ 一般來說，站點佈局不需要是正交的，儘管通常是正交的。
+ 然而，只有當 TF 位於正交坐標系中並且與地理北的角度已知時，才能對其進行解釋。
+ 在歷史 EDI 文件中，很少能找到數據方向明確的記錄（請參閱本文隨附的示例）。
+ 除了詮釋資料之外，數據錯誤的估計一直是MT數據處理中最具挑戰性的部分。
+ 完整的協方差矩陣可以被定義為將不同的 TF 分量統計地關聯在一起（例如，Eisel 和 Egbert，2001）。
+ 這些信息不僅僅具有理論上的意義，因為有必要通過數據旋轉來監督嚴格估計的誤差線。
+ EMTF 是矩陣，並且考慮到一般統計協方差將需要存儲一個矩陣來伴隨每個數據分量。
+ 傳統的 EDI MT 文件不太適合矩陣存儲，並且這些信息總是被忽略。
+ 另一方面，為了重新解釋這些歷史數據，通常需要進行數據旋轉。
+ 這說明了數據格式的平凡問題如何具有長期的科學意義。
+ EDI 文件的變體 EDI SPECTRA 文件以無法解釋的格式存儲 EMTF；在使用它們之前，必須先應用處理代碼。
+ 然而，與更常見的 EDI MT 文件相比，EDI SPECTRA 包含在任何右手坐標系中完整 EMTF 和要提取的協方差矩陣的足夠信息。
+ 其他常用的 EMTF 文件格式，J 格式（Jones 等人，1983）、EMTF Z 文件（Eisel 和 Egbert，2001）和 BIRRP 格式（Chave 等人，1987），它們是相應的處理代碼，並非都同樣缺乏錯誤估計信息。
+ 然而，它們都遭受了幾乎完全缺乏詮釋資料的困擾。
+ 這是可以理解的：這些文件的目的是在單個研究小組和單個項目的框架內進行立即分析，而不是在幾十年後共享或重新分析。 他們完美地達到了他們的目的。
+ 直到現在，詮釋資料的缺乏和文件格式的可變性才成為大規模數據再分析所允許的概念性新科學的絆腳石。
+ 事實上，可以毫不誇張地說，所有歷史數據都缺乏以可能與原始項目預期不同的方式解釋數據所必需的一條或另一條關鍵信息。
+ 從時間序列到 TF，確實需要將各種 MT 數據格式現代化為完全記錄、獨立於平台且可擴展的通用標準。
+ 這一需求得到了全球 EM 界的廣泛認可，近年來，全球 EM 界對 MT 和其他 EM 標準現代化給予了極大關注。
+ 2011 年，SEG 成立了電磁數據標準小組委員會，負責審查自描述數據格式，以促進海洋受控源電磁 (CSEM) 和大地電磁現場數據的交換。
+ 2015年10月，內存密集型時間序列數據的SEG-D 3.0標準的EM現場數據組件最終確定。
+ 同時，澳大利亞SEG針對各類EM數據成立了並行工作組； 據我們所知，沒有根據這一努力發表任何報告。
+ 然而，除了我們小組之外（IRIS EMTF，2018；Kelbert 等人，2011，2018），還沒有建立可搜索的元數據框架來使非商業EM 數據集可在線發現，並且EMTF 數據格式的現代化尚未實現。已得到解決。
+ 在本出版物發佈時，最近建立了一項國際合作（Kelbert 等人，2018），旨在開發電磁數據共享的新標準，該標準將具有自描述性、機器可讀性和可發現性。
+ 在本出版物發佈時，最近建立了一項國際合作（Kelbert 等人，2018），旨在開發電磁數據共享的新標準，該標準將具有自描述性、機器可讀性和可發現性。
+ 通過 EPOS 提供的數據將符合通用標準，並可從單一門戶獲取，以支持跨學科研究。
+ 這包括 MT 數據和電導率模型。
+ 呂勒奧理工大學負責在 EPOS 內實施 MT 數據和模型 (MTDAMO) 服務。
+ 德國波茨坦地球物理儀器庫（GIPP）實驗和數據存檔是地球物理實驗數據長期存檔的平台。
+ 在美國，EarthScope MT（2006-2018）是由俄勒岡州立大學（OSU）領導的國家科學基金會（NSF）的一個項目。
+ 俄勒岡州立大學、美國地質調查局和地震學聯合研究機構 (IRIS) 之間的合作生成了第一個可搜索 MT 數據的開放數據庫：IRIS EMTF。
+ NSF 的 EarthCube 是一項正在進行的計劃，致力於實現整個地球科學領域的數據共享、互操作性和可重複性。
+ 在澳大利亞，AuScope（2007-2018）提供了 MT 儀器，使研究人員能夠對地球地下進行成像。
+ 澳大利亞地球科學局以及澳大利亞州和領地地質調查局和研究機構根據政府計劃收集大地電磁數據。
+ 所有這些都可以通過從其站點下載傳統文件的方式訪問 MT 數據，有些使用國家虛擬實驗室計算基礎設施和基於高性能計算的 MT 數據處理。
+ 這些項目中的每一個都旨在以自我描述、文檔齊全、高效且可搜索的方式向公眾提供數據。
+ 為此，正在開發數據格式和歸檔策略。
+ 詮釋資料內容和歸檔策略的國際合作和融合將實現各自格式和數據庫之間的互操作性，以確保用戶流暢的數據交互體驗。
+ 策略涉及通用或一致的詮釋資料模型、彼此服務器的鏡像、格式轉換工具的開發以及確保增強國際數據的備份和可訪問性的其他途徑。
+ 我們希望我們的工作能夠為 EMTF 數據共享領域的這些努力提供幫助。
+ 我們在本出版物中提出的格式可能會也可能不會成為正式的國際標準，但它將引起人們對MT數據和詮釋資料的問題和微妙之處的關注，這不依賴於文件格式規範的細節。
+ 在這裡，我們基於可擴展標記語言 (XML) 為這些問題提供了完整的解決方案，並描述了我們自己的格式 EMTF XML，它能夠存儲任何 EMTF 數據文件中的信息而不會丟失內容。
+ 基於 XML 的格式是可擴展的、獨立於平台的，並且在設計上是自描述的； 它們也非常適合檔案系統和可搜索訪問機制。
+ 與時間序列相反，EMTF 不是存儲或內存密集型的； 同時，它們包含對於長期存儲和進一步解釋（即反演）至關重要的複雜元數據。
+ XML 框架非常適合完整、簡潔地表示這些 TF 以實現共享。
+ 基於矩陣的數據存儲方法允許（但不要求）在 EMTF XML 數據文件中包含完整的統計協方差矩陣。
+ 我們使用用 Fortran 90 編寫的開源轉換工具來配合這一開發。
+ 這些轉換工具功能非常強大，可以竭盡全力解析歷史文件格式的完整可變性，並將其轉換為新的 EMTF XML 數據格式。
+ 這些工具還允許從 EMTF XML 到這些歷史格式的有損轉換，以符合 MT 社區以前建立的工作流程。
+ EM 時間序列的存儲不是當前出版物的重點，但我們注意到為 TF 開發的詮釋資料解決方案也可以應用於時間序列共享和歸檔，只需稍加修改。

### CRITICAL METADATA FOR EM TFs
+ 詮釋資料對於長期數據歸檔和共享至關重要。
+ 對於 XML 詮釋資料，我們定義了一組最小字段，使數據具有自描述性。
+ 其中包括正式版權和使用條件、地理名稱和位置、數據質量標識符、數據來源、處理假設以及時間段和期間範圍。
+ 這些字段是可搜索的，並且許多字段可以在地圖上進行顏色編碼，從而可以輕鬆查看和提取必要的數據內容。
+ 該結構非常靈活，並針對可選但有用的附加元數據進行設置，包括儀器設置和其他（更多MT 特定的）詳細信息，通過可選XML 列表（示例12）提供，作為使用提供的轉換軟件創建EMTF XML 文件的一部分、電磁傳輸功能文件轉換實用程序（EMTF FCU）。
+ EMTF XML 中預計包含五個元素：Provenance、Copyright、Site、FieldNotes 和ProcessingInfo。
+ 它們按照 EMTF XML 中預期的順序在此處列出。
+ 然而，為了進行討論，我們採取更自由的方法，並按相關性順序涵蓋材料。
+ XML 是一種靈活且可擴展的語言，因此只要存在此信息，通常就可以對其進行解析；
+ 但是，為了與歸檔數據庫實現最佳兼容性，我們建議保持元素順序。
+ 根據我們的經驗，示例 XML 通常比 XML schema 對社區更具描述性；
+ 因此，我們的 XML 模式不再受支持。
+ 相反，附錄 C 以及本文的數字附件（可在第一頁的腳註中找到）提供了幾個完整的工作示例。

#### Site identification and location
+ 站點定義了關鍵元數據，通過提供明確的地理位置來唯一標識項目內以及全球範圍內的 TF。
+ 詳細信息請參見附錄（清單 3）。
+ 在這裡，我們指定了關鍵項目，旨在為負責數據的大規模數據收集傘提供簡潔、理想的縮寫形式。
+ 這可能是一項重大的政府舉措、一個機構或類似的指標。
+ 一個項目可以包含多個調查。
+ 還提供了調查，並且是自由格式的文本。
+ 調查定義了由共同作者、數據收集年限和探索目標聯合而成的數據集合。
+ 我們還將 YearCollected 和 Country 指定為關鍵詮釋資料。
+ 網站本身在調查中通過簡潔且唯一的標識符 (Id) 和名稱進行標識。
+ 後者是人類可讀的地理位置，可用於粗略地定位站點； 這通常是最近的村莊或地理特徵的全名（例如，Little Moose Pond，ME，USA）。
+ 最後，有效的 EMTF XML 需要完整的地理位置。
+ 為了完整起見，我們始終指定基準面、緯度、經度和海拔。
+ 赤緯（帶有紀元）是可選的，但很方便的詮釋資料。
+ 請注意，大小寫在 XML 中很重要。
  ```xml
  <Location datum="WGS84">
  <Latitude>45.532102</Latitude>
  <Longitude>-69.864103</Longitude>
  <Elevation units="meters">361.725</Elevation>
  </Location>
  ```

#### Timing and data quality
+ 對於 EMTF 來說，數據收集的時間通常不那麼重要。
+ 然而，在搜索特定磁事件期間收集的原始時間序列時，這是一個有用的細節。
+ 我們要求指定開始和結束時間；如果未知，我們會指定參考日期或數據收集年份。
+ 如果未知，我們會指定參考日期或數據收集年份。
+ 最後，我們定義了一個評估數據質量的簡單量表。
+ 數據質量評級從 0 到 5，如表 1 中所述（調查的默認值可以在配置文件中指定；請參見清單 1 和 2）。
+ 數據質量標誌通常為零，如果數據由於文化噪音問題或其他非物理行為而需要人工關注，則設置為 1。
+ 註釋字段提供了解釋的空間。
+ 在數據庫搜索期間，可以將評級和標誌值繪製在地圖上。

#### Data orientation
+ MT 和其他 EM TF 數據在現場以各種方向記錄。
+ 儘管磁場通道始終彼此成直角，且第一磁場分量 HX 最常指向地磁北，但電場通道以“X”、“L”或“ T”形狀，使得第一電場分量EX 在給定場條件的情況下盡可能接近地磁或地理北。
+ 在某些比人們想像的更頻繁發生的具有挑戰性的現場環境中，通道被定向到可能偏離正交的其他任意方向。
+ 為了正確解釋數據，正確記錄這些通道方向至關重要。
+ 然而，在希望將測量結果與其他數據聯合使用的分析中，用戶將 TF 旋轉到公共正交坐標係也很重要。
+ 對於現代 3D 解釋，最常見的是在面向地理北方的坐標系中解釋數據。
+ 許多舊數據文件在數據方向方面不明確，並且它們經常會丟失關鍵信息（示例 5），或者它們包含多個相互衝突的消息（示例 2）。
+ 此外，EDI 數據文件（除非它們包括 SPECTRA，正如我們在下一節中詳細描述的那樣）不包含足夠的信息來統計正確的誤差線旋轉。
+ 因此，我們的初衷是按照提供的數據進行存檔，而不進行數據旋轉。
+ 在此策略中，我們假設數據面向站點佈局，如輸入和輸出通道方向所定義，例如，
  ```xml
  <InputChannels ref="site" units="m">
  <Magnetic name="Hx" orientation="0.0" x="0.0" y="0.0" z="0.0"/>
  <Magnetic name="Hy" orientation="90.0" x="0.0" y="0.0" z="0.0"/>
  </InputChannels>
  <OutputChannels ref="site" units="m">
  <Magnetic name="Hz" orientation="0.0" x="0.0" y="0.0" z="0.0"/>
  <Electric name="Ex" orientation="0.0" x="-50.0" y="0.0" z="0.0" x2="50.0" y2="0.0" z2="0.0"/>
  <Electric name="Ey" orientation="90.0" x="0.0" y="-40.0" z="0.0" x2="0.0" y2="40.0" z2="0.0"/>
  </OutputChannels>
  ```
